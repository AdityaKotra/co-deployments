---
apiVersion: v1
kind: Pod
metadata:
  name: test-pod-csi-{{ .Release.Name }}
  namespace: default
  labels:
    plugin: {{ .Release.Name }}
  annotations:
    "helm.sh/hook": test-success
spec:
  containers:
  - name: test-pvc-container
    image: busybox
    command: ["/bin/sh", "-c"]
    args:
        - echo `date` > /storage/time.txt
    # Mount the volume into the pod
    volumeMounts:
    - name: storage
      mountPath: "/storage"
    # Refer to the PVC created earlier
  volumes:
  - name: storage
    persistentVolumeClaim:
      # Name of the PVC created earlier
      claimName: hpe-csi-test-pvc
  restartPolicy: Never
